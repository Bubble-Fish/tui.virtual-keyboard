/*!
 * tui-virtual-keyboard.min.js
 * @version 2.0.1
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery"),require("tui-code-snippet")):"function"==typeof define&&define.amd?define(["jquery","tui-code-snippet"],t):"object"==typeof exports?exports.VirtualKeyboard=t(require("jquery"),require("tui-code-snippet")):(e.tui=e.tui||{},e.tui.VirtualKeyboard=t(e.$,e.tui&&e.tui.util))}(this,function(e,t){return function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="dist",t(0)}([function(e,t,i){"use strict";var n=i(1),s=i(2),a=s.defineClass({init:function(e,t){this._initVariables(t||{}),this._arrangeKeySequence(),this._refineKeyMap(),this._initKeyboard(e),this._attachEvent(t.isClickOnly)},_template:{key:'<li><button type="button" value="{KEY}">{KEY}</button></li>',blank:"<li></li>"},_fixedKeys:{},_rawKeys:[],_identifiedRawKeys:[],_keyMap:{},_keySequences:[],_callback:{},_currentKeyType:null,_isEnglish:!1,_isSymbol:!1,_isCapsLock:!1,_documentFragment:null,_initVariables:function(e){this._currentKeyType=e.keyType||"english",this._fixedKeys=e.functions||{},this._rawKeys=this._copyArray(e.keys),this._template=s.extend(this._template,e.template),this._callback=e.callback||{},this._documentFragment=document.createDocumentFragment()},_attachEvent:function(e){var t=!e&&("createTouch"in document||"ontouchstart"in document),i=t?"touchstart":"click";this._$container.on(i,n.proxy(this._pressKeyHandler,this))},_pressKeyHandler:function(e){var t,i,n,a=this._getTargetButton(e.target);s.isExisty(a)&&(t=a.value,i=this._getKeyGroup(t),n=this._keyMap[t].rawIndex,"key"===i?this._executeCallback(i,n):(this[t](),this._executeCallback(t)))},_getTargetButton:function(e){var t;return t="BUTTON"===e.tagName.toUpperCase()?e:n(e).parent("button")[0]},_arrangeKeySequence:function(){var e;e=this._sortFixedKeys(),this._identifyRawKeys(),this._copyArray(this._identifiedRawKeys,this._keySequences),s.forEach(e,function(e){s.isExisty(e)&&this._keySequences.splice(this._fixedKeys[e],0,e)},this)},_identifyRawKeys:function(){var e=0;s.forEach(this._rawKeys,function(t,i){"blank"===this._getKeyGroup(t)&&(t="blank"+e,e+=1),this._identifiedRawKeys[i]=t},this)},_copyArray:function(e,t){return!!s.isExisty(e)&&(s.isArray(e)||(e=[e]),s.isExisty(t)&&s.isArray(t)||(t=[]),s.forEach(e,function(e,i){t[i]=e},this),t)},_sortFixedKeys:function(){var e;return this._keySequences.length=0,e=s.keys(this._fixedKeys)||[],e.sort(n.proxy(function(e,t){return this._fixedKeys[e]-this._fixedKeys[t]},this)),e},_refineKeyMap:function(){this._refineFixedKeys(),this._refineFloatingKeys()},_refineFixedKeys:function(){s.forEach(this._fixedKeys,function(e,t){this._keyMap[t]={key:t,rawIndex:null,positionIndex:e,keyGroup:this._getKeyGroup(t)}},this)},_refineFloatingKeys:function(){s.forEach(this._identifiedRawKeys,function(e,t){s.isExisty(this._keyMap[e])?(this._keyMap[e].positionIndex=this._getPositionIndex(e),this._keyMap[e].rawIndex=t):this._keyMap[e]={key:e,rawIndex:t,positionIndex:this._getPositionIndex(e),keyGroup:this._getKeyGroup(this._rawKeys[t])}},this)},_getKeyGroup:function(e){var t;return t=s.isExisty(this._fixedKeys[e])?"function":""===e?"blank":"key"},_getPositionIndex:function(e){for(var t,i=0,n=this._keySequences.length;i<n;i+=1)if(e===this._keySequences[i]){t=i;break}return t},_initKeyboard:function(e){this._initContainer(e),this._arrangeKeys()},_initContainer:function(e){this._$container?s.forEach(this._identifiedRawKeys,function(e){this._documentFragment.appendChild(this._keyMap[e].element)},this):(s.isString(e)?this._$container=n("#"+e):this._$container=n(e),s.isHTMLTag(this._$container[0])||(this._$container=this._createContainer()))},_createContainer:function(){var e="vk-"+this._getTime(),t=n("<ul id="+e+">");return n(document.body).append(t),t},_getTime:function(){var e;return Date.now&&(e=Date.now()||(new Date).getTime()),e},_arrangeKeys:function(){var e;s.forEach(this._keySequences,function(t){e=this._keyMap[t].element,s.isHTMLTag(e)||(this._keyMap[t].element=e=this._createKeyElement(t)),this._$container.append(e)},this)},_getTemplate:function(e,t){var i;return i="blank"===e?this._template.blank:this._template[t]||this._template.key,s.isExisty(t)&&(i=i.replace(/{KEY}/g,t)),i},_createKeyElement:function(e){var t=this._keyMap[e].keyGroup,i=this._getTemplate(t,e),a=n(i),r=a.find("button");return!r.val()&&s.isExisty(e)&&r.val(e),a[0]},_reArrangeKeys:function(e){this._rawKeys.length=0,this._keySequences.length=0,this._copyArray(e,this._rawKeys),this._arrangeKeySequence(),this._refineFloatingKeys(),this._arrangeKeys()},_executeCallback:function(e,t){s.isExisty(this._callback,e)&&s.isFunction(this._callback[e])&&this._callback[e](t)},_getRawKeys:function(e){var t;s.isExisty(this._callback,"getKeys")&&s.isFunction(this._callback.getKeys)&&(t=e?this._callback.getKeys(this._currentKeyType,this._isCapsLock,!0):this._callback.getKeys(this._currentKeyType,this._isCapsLock)),s.isArray(t)&&this._reArrangeKeys(t)},shuffle:function(){this._keySequences.length=0,this._initContainer(),this._getRawKeys()},language:function(){this._initContainer(),this._isEnglish=!this._isEnglish,this._currentKeyType=this._isEnglish?"english":"korean",this._getRawKeys()},caps:function(){this._initContainer(),this._isCapsLock=!this._isCapsLock,this._getRawKeys(!0)},symbol:function(){this._initContainer(),this._isSymbol=!this._isSymbol,this._currentKeyType=this._isSymbol?"symbol":"number",this._getRawKeys()},remove:function(){},clear:function(){},space:function(){},open:function(){this.shuffle(),this._$container.show()},close:function(){this.clear(),this._$container.hide()},done:function(){this.close()}});e.exports=a},function(t,i){t.exports=e},function(e,i){e.exports=t}])});